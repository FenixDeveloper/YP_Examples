(()=>{"use strict";function t(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(o,a){setTimeout((function(){r&&console.log("Timer (".concat(t,"): ").concat(n?"resolved":"rejected")),n?o("Result ".concat(t)):a("Error ".concat(t))}),e)}))}function e(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){c=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw i}}}}function r(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var a=["type"];function i(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=s(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){u=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw a}}}}function s(t,e){if(t){if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var d={"text.min":[function(t,e){return t.length>=e},function(t){return"Length must be more than ".concat(t)}],"number.min":[function(t,e){return t>=e},function(t){return"Value must be more than ".concat(t)}],"text.max":[function(t,e){return t.length<=e},function(t){return"Length must be less than ".concat(t)}],"number.max":[function(t,e){return t<=e},function(t){return"Value must be less than ".concat(t)}],"boolean.value":[function(t,e){return t===e},function(t){return"You must agree"}]};function m(t,e,n){var r,o,a=[];for(var i in n){var u="".concat(e,".").concat(i);if(d[u]){var c=(o=2,function(t){if(Array.isArray(t))return t}(r=d[u])||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a=[],i=!0,u=!1;try{for(n=n.call(t);!(i=(r=n.next()).done)&&(a.push(r.value),!e||a.length!==e);i=!0);}catch(t){u=!0,o=t}finally{try{i||null==n.return||n.return()}finally{if(u)throw o}}return a}}(r,o)||s(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=c[0],f=c[1];l(t,n[i])||a.push(f(n[i]))}}return a}var b,p,v,h,g,O,S={text:"text",textarea:"text",number:"number",checkbox:"boolean"};function w(t,e,n){var r,o=t.parentElement.querySelector(".field-error");return{parent:t.parentElement,setError:function(t){return!!o&&(o.innerText=t)},getValue:(r=t,"checkbox"===r.type?function(){return r.checked}:function(){return r.value}),input:t,type:e,rules:n}}function j(t,e){!function(t){var e,n=t.form,r=t.schema,o=t.onReady,u=t.onChange,d=t.onSubmit,m={},b=(e=n.elements,function(t){if(Array.isArray(t))return y(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).filter((function(t){return"submit"===t.type})).pop();if(r)for(var p in r){var v=r[p],h=v.type,g=i(v,a),O=n.elements[p];m[p]=w(O,h,g)}else{var j,A=f(n.elements);try{for(A.s();!(j=A.n()).done;){var E=j.value,x=S[E.type];if(x&&E.name){var I=c({},E.dataset);for(var P in I)I[P]=JSON.parse(I[P]);E.parentElement.querySelector(".field-error"),m[E.name]=w(E,x,I)}}}catch(t){A.e(t)}finally{A.f()}}o&&o({form:n,fields:m,submit:b}),n.addEventListener("keyup",(function(t){return u({event:t,form:n,fields:m,submit:b})})),n.addEventListener("change",(function(t){return u({event:t,form:n,fields:m,submit:b})})),n.addEventListener("submit",(function(t){return t.stopPropagation(),t.preventDefault(),d({event:t,form:n,fields:m,submit:b,data:Object.keys(m).reduce((function(t,e){return Object.assign(t,l({},e,m[e].getValue()))}),{})})}))}({form:t,schema:e,onReady:function(t){var e=t.submit,n=t.fields;e.disabled=!0,console.log(n)},onChange:function(t){var e=t.fields,n=t.submit,r=!1;for(var o in e){var a=e[o],i=a.setError,u=a.getValue,c=a.type,l=a.rules;i("");var f=u(),s=m(f,c,l);s.length>0&&(String(f)&&i(s.join(", ")),r=!0)}n.disabled=r},onSubmit:function(t){var e=t.data;console.log("Submit: ",e)}})}p=(b={editor:"clipboard",copy:"copy",paste:"paste"}).editor,v=b.copy,h=b.paste,g=document.getElementById(p),O=document.getElementById(v),document.getElementById(h).addEventListener("click",(function(){navigator.clipboard.readText().then((function(t){return g.value=t}))})),O.addEventListener("click",(function(){navigator.clipboard.writeText(g.value).then((function(){return alert("clipboard set to ".concat(g.value))})).catch((function(){return alert("Can not set clipboard!")})).finally((function(){return g.value=""}))})),function(){var t,e=f(document.forms);try{for(e.s();!(t=e.n()).done;)j(t.value)}catch(t){e.e(t)}finally{e.f()}}(),window.tests={timer:t,cases:{good:[["A",300],["B",200],["C",100]],bad:[["A",300],["B",200,!1],["C",100]],bad2:[["A",300],["B",200],["C",100,!1]]},testSyncCode:function(){console.group("sync test"),console.log("step 1"),function(t,e){var r,o,a=n([2,3,4]);try{for(a.s();!(r=a.n()).done;)o=r.value,console.log("step ".concat(o))}catch(t){a.e(t)}finally{a.f()}}(),console.log("step 5"),console.groupEnd()},testASyncCode:function(){console.group("async test"),console.log("step 1"),function(e,r){var o,a=n([2,3,4]);try{var i=function(){var e=o.value;t(e,100*e,!0,!1).then((function(){return t=e,console.log("step ".concat(t));var t}))};for(a.s();!(o=a.n()).done;)i()}catch(t){a.e(t)}finally{a.f()}}(),console.log("step 5"),console.groupEnd()},testPromise:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=arguments.length>1?arguments[1]:void 0;Promise[n](r.map((function(n){return t.apply(void 0,e(n))}))).then((function(t){return console.log("then: ",t)})).catch((function(t){return console.log("catch: ",t)})).finally((function(){return console.log("finally.")}))}}})();